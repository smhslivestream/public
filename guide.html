<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SMHS Livestream Help Guide</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
    body {
        font-family: system-ui, sans-serif;
        margin: 0;
        padding: 20px;
        background: #f3f4f6;
    }

    h1 {
        text-align: center;
        margin-bottom: 30px;
        color: #1f2937;
    }

    #guideContainer {
        max-width: 900px;
        margin: 0 auto;
    }

    .guideItem {
        background: #ffffff;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 18px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }

    .guideTitle {
        font-size: 1.4rem;
        font-weight: 600;
        margin-bottom: 10px;
        color: #111827;
    }

    .guideDesc {
        font-size: 1rem;
        margin-bottom: 12px;
        color: #374151;
        white-space: pre-wrap;
    }

    .guideLink a {
        background: #2563eb;
        color: #fff;
        padding: 8px 14px;
        border-radius: 6px;
        text-decoration: none;
        font-weight: 500;
    }

    .guideLink a:hover {
        background: #1d4ed8;
    }

    #loading {
        text-align: center;
        font-size: 1.1rem;
        padding: 20px;
        color: #6b7280;
    }

    #error {
        text-align: center;
        font-size: 1.1rem;
        padding: 20px;
        color: #b91c1c;
        display: none;
    }
</style>
</head>
<body>

<h1>Livestream Help Guide</h1>

<div id="loading">Loading guideâ€¦</div>
<div id="error">Failed to load guide. Please try again later.</div>
<div id="guideContainer"></div>

<script>
// ðŸ”— IMPORTANT: Replace this with your RAW GitHub link
// Example:

const GUIDE_JSON_URL = "https://raw.githubusercontent.com/smhslivestream/event-links/main/guide.json";

async function loadGuide() {
    const loading = document.getElementById("loading");
    const error = document.getElementById("error");
    const container = document.getElementById("guideContainer");

    try {
        const res = await fetch(GUIDE_JSON_URL + "?cache=" + Date.now());
        if (!res.ok) throw new Error("HTTP " + res.status);

        const json = await res.json();
        const items = json.items || [];

        loading.style.display = "none";

        if (items.length === 0) {
            container.innerHTML = "<p>No help items found.</p>";
            return;
        }

        container.innerHTML = items.map(item => {
    const link = item.link || "";

    let preview = `<div style="color:#6b7280;">(Preview not available)</div>`;

    // YouTube detection
    const yt = link.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/)([A-Za-z0-9_-]+)/);
    if (yt) {
        preview = `
        <iframe
            width="100%"
            height="315"
            src="https://www.youtube.com/embed/${yt[1]}"
            frameborder="0"
            allowfullscreen
            style="border-radius:8px;">
        </iframe>
        `;
    }

    // Vimeo detection
    const vimeo = link.match(/vimeo\.com\/(\d+)/);
    if (vimeo) {
        preview = `
        <iframe
            src="https://player.vimeo.com/video/${vimeo[1]}"
            width="100%"
            height="315"
            frameborder="0"
            allow="fullscreen"
            style="border-radius:8px;">
        </iframe>
        `;
    }

    // Streamable
    const streamable = link.match(/streamable\.com\/(\w+)/);
    if (streamable) {
        preview = `
        <iframe 
            src="https://streamable.com/e/${streamable[1]}"
            width="100%" 
            height="315" 
            frameborder="0"
            style="border-radius:8px;">
        </iframe>
        `;
    }

    return `
        <div class="guideItem">
            <div class="guideTitle">${item.title}</div>
            <div class="guideDesc">${item.description}</div>

            <div class="guideLink">
                <a href="${link}" target="_blank">ðŸ”— Open Video</a>
            </div>

            <div class="guidePreview" style="margin-top:12px;">
                ${preview}
            </div>
        </div>
    `;
}).join("");

    }
    catch (err) {
        console.error("Guide load failed:", err);
        loading.style.display = "none";
        error.style.display = "block";
    }
}

loadGuide();
</script>

</body>
</html>
